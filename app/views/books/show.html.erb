<div class='container'>
  <div class='row'>
    <%= render 'layouts/sidebar', user: @user, book: @book_new %>
    <div class='col-md-8 offset-md-1'>
      <h2>Book detail</h2>
      <table class='table'>
        <tr>
          <td><%= link_to user_path(@book.user) do %><%= image_tag @book.user.get_profile_image(80, 80) %><br><%= @book.user.name %><% end %></td>
          <td><%= link_to book_path(@book) do %><%= @book.title %><% end %></td>
          <td><%= @book.body %></td>
          <td><%= render 'favorites/button', book: @book %></td>
          <td><p>コメント数: <%= @book.book_comments.count %></p></td>
          <% if @book.user_id == current_user.id %>
            <td><%= link_to 'Edit', edit_book_path(@book), class: "btn btn-success" %></td>
            <td><%= link_to 'Destroy', book_path(@book), method: :delete, data: { confirm: '本当に消しますか？' }, class: "btn btn-danger" %></td>
          <% end %>
        </tr>
      </table>

      <table class='table'>
        <% @book.book_comments.each do |comment| %>
          <tr>
            <td><%= link_to user_path(comment.user) do %><%= image_tag comment.user.get_profile_image(50, 50) %><br><%= comment.user.name %><% end %></td>
            <td><%= comment.comment %></td>
            <% if comment.user_id == current_user.id %>
              <td><%= link_to 'Destroy', book_book_comment_path(@book, comment), method: :delete, class: "btn btn-danger" %></td>
            <% end %>
          </tr>
        <% end %>
      </table>

      <%= form_with model: [@book, @book_comment] do |f| %>
        <div class='form-group'>
          <%= f.text_area :comment, class: "form-control", placeholder: "コメントを入力" %>
        </div>
        <div class='form-group'>
          <%= f.submit "送信", class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
